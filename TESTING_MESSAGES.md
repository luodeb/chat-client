# 消息管理功能测试指南

## 功能概述

现在应用已经实现了基于 Pinia 的插件消息管理系统，具有以下特性：

### ✅ 已实现的功能

1. **按插件分类管理消息**
   - 每个插件的消息独立存储
   - 切换插件时自动显示对应插件的消息记录

2. **持久化存储**
   - 消息自动保存到 localStorage
   - 应用重启后自动加载历史消息

3. **消息类型区分**
   - 发送的消息标记为 'sent'
   - 接收的消息标记为 'received'

4. **清空消息功能**
   - 可以清空当前插件的消息
   - 支持清空所有插件的消息

5. **消息统计显示**
   - 在配置面板显示当前插件消息数量
   - 显示所有插件的总消息数量

## 测试步骤

### 1. 基本消息发送和接收测试

1. 启动应用 (`npm run tauri dev`)
2. 在左侧配置面板选择 "Example Plugin"
3. 点击"连接"按钮连接插件
4. 在下方输入框输入消息，点击"发送"
5. 观察上方消息显示区是否显示：
   - 你发送的消息（标记为发送类型）
   - 插件的响应消息（标记为接收类型）

### 2. 消息持久化测试

1. 发送几条消息
2. 关闭应用
3. 重新启动应用
4. 检查消息是否仍然存在

### 3. 插件切换消息隔离测试

1. 在 Example Plugin 中发送一些消息
2. 如果有其他插件，切换到其他插件
3. 观察消息显示区是否为空（因为其他插件没有消息记录）
4. 切换回 Example Plugin
5. 检查之前的消息是否重新显示

### 4. 清空消息测试

1. 发送一些消息
2. 点击消息显示区右上角的"清空消息"按钮
3. 观察消息是否被清空
4. 重启应用，检查消息是否确实被删除

### 5. 消息统计测试

1. 在配置面板观察消息统计信息
2. 发送消息后，检查统计数字是否更新
3. 清空消息后，检查统计数字是否归零

## 预期行为

### 正常情况下应该看到：

1. **消息显示**：
   - 发送的消息显示在右侧，带有时间戳
   - 接收的消息显示在左侧，带有时间戳
   - 消息按时间顺序排列

2. **消息统计**：
   - 配置面板显示当前插件消息数量
   - 总消息数量正确统计

3. **持久化**：
   - 重启应用后消息不丢失
   - 清空消息后重启应用，消息确实被删除

4. **插件隔离**：
   - 不同插件的消息互不干扰
   - 切换插件时显示对应插件的消息

## 调试信息

打开浏览器开发者工具的控制台，应该能看到：
- "消息 Store 已初始化" 的日志
- 消息发送和接收的相关日志

## 数据存储位置

消息数据存储在浏览器的 localStorage 中，键名为：`chat-client-messages`

可以在开发者工具的 Application -> Local Storage 中查看存储的数据。

## 故障排除

如果遇到问题：

1. **消息不显示**：检查控制台是否有错误信息
2. **消息不持久化**：检查 localStorage 是否被禁用
3. **插件切换问题**：确保插件正确挂载和连接
4. **统计数字不更新**：检查 Pinia store 的响应式是否正常工作
